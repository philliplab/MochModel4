---
title: "MochModel4 Tests"
author: "Phillip Labuschagne"
date: "Tuesday, July 22, 2014"
output: html_document
---

```{r}
rm(list = ls())
library(modgenTester)
sd <- "C:/Users/Administrator/Documents/Visual Studio 2010/Projects/MochModel4"
td <- "C:/Users/Administrator/Documents/Visual Studio 2010/Projects/MochModel4/test"

copy_model(sd, 'MochModel4.exe', td)
copy_scenario(sd, 'Base.scex', 'Base(MotherCore).dat', td)
```

```{r}
scenarios_to_create <- list(
  '1' = list(test_folder = td, 
             base_scenario = 'Base.scex', 
             base_scenario_dat = 'Base(MotherCore).dat',
             scenario_name_sub = list(from = 'Base', to = 'Small'), 
             scex_sub = list(), 
             dat_sub = list('1' = list(from = 'int\tStartingPopulationSize = 10000;',
                                       to = 'int\tStartingPopulationSize = 1000;')
                            )
             ),
  '2' = list(test_folder = td, 
             base_scenario = 'Base.scex', 
             base_scenario_dat = 'Base(MotherCore).dat',
             scenario_name_sub = list(from = 'Base', to = 'NoHIV'), 
             scex_sub = list(), 
             dat_sub = list('1' = list(from = 'IncidenceMotherMultiplier = 1',
                                       to = 'IncidenceMotherMultiplier = 0')
                            )
             ))
for (i in scenarios_to_create){
  do.call(generate_scenario, i)
}
```

```{r}
available_scenarios <- list_all_scenarios(td, FALSE)
```

```{r, eval=FALSE}
for (scenario in available_scenarios){
  print(scenario)
  run_scenario(td, scenario$scex,
               td, "MochModel4.exe")
}
```

```{r}
all_results <- list_all_results(td)
```

```{r}
for (i in all_results){
  print(i)
  db_channel <- access_database(i)
  print('Parameter Tables:')
  print(list_parameter_tables(db_channel))
  print('Result Tables:')
  print(list_result_tables(db_channel))
}
```